# Vulnerability Scanning

The vulnerability module provides scanning capabilities to detect known security vulnerabilities in packages.

## Overview

This module integrates with multiple vulnerability databases to scan packages for known security issues. It provides detailed reports including vulnerability severity, affected versions, and remediation information.

## Usage

### Scanning Packages for Vulnerabilities

```rust
use package_fast_security::vulnerability::scan_for_vulnerabilities;

let report = scan_for_vulnerabilities("package-name", "1.0.0").await?;

println!("Found {} vulnerabilities", report.vulnerabilities.len());

for vulnerability in &report.vulnerabilities {
    println!("Vulnerability: {} - Severity: {:?}", 
             vulnerability.title, vulnerability.severity);
}
```

### Checking Vulnerability Severity

```rust
use package_fast_security::vulnerability::{scan_for_vulnerabilities, Severity};

let report = scan_for_vulnerabilities("package-name", "1.0.0").await?;

if let Some(highest_severity) = report.highest_severity() {
    match highest_severity {
        Severity::Critical | Severity::High => {
            println!("Critical or high severity vulnerabilities found!");
        }
        _ => {
            println!("Moderate or low severity vulnerabilities found");
        }
    }
}
```

## Vulnerability Report Structure

The `VulnerabilityReport` contains:

- `package_name`: Name of the scanned package
- `package_version`: Version of the scanned package
- `vulnerabilities`: List of found vulnerabilities
- `scan_timestamp`: When the scan was performed

Each `Vulnerability` contains:

- `id`: Unique identifier (e.g., CVE number)
- `title`: Brief description of the vulnerability
- `description`: Detailed description
- `severity`: Severity level (Low, Medium, High, Critical)
- `affected_versions`: Version constraints that are affected
- `patched_versions`: Versions that fix the vulnerability
- `references`: Links to advisories and additional information

## Supported Vulnerability Databases

The module can integrate with:

1. **National Vulnerability Database (NVD)**: Comprehensive vulnerability database maintained by NIST
2. **Open Source Vulnerabilities (OSV)**: Google's vulnerability database for open source projects
3. **GitHub Advisory Database**: GitHub's security advisories for open source packages

## Security Considerations

- Regular vulnerability scanning is essential for maintaining security
- Pay special attention to Critical and High severity vulnerabilities
- Keep packages updated to patched versions when vulnerabilities are found
- Consider using automated vulnerability scanning in CI/CD pipelines

## Performance

Vulnerability scanning is designed to be efficient:

- Asynchronous database queries
- Caching of vulnerability data
- Parallel scanning of multiple packages
- Configurable timeouts to prevent hanging

## Integration

This module integrates with:
- Package resolution to scan dependencies
- Installation process to block vulnerable packages
- Security audit trails for vulnerability scans
- Reporting systems for security dashboards